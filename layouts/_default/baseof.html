<!DOCTYPE html>
<html lang="{{ with .Site.LanguageCode }}{{ . }}{{ else }}en-US{{ end }}">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  {{- partial "favicon.html" . -}}
  <title>{{- block "title" . }}{{ with .Title }}{{ . }} | {{ end }}{{ .Site.Title }}{{- end }}</title>

  {{- partial "seo_tags.html" . -}}
  <meta name="referrer" content="no-referrer-when-downgrade" />

  {{- partial "style.html" . -}}
  
  <!-- CSV Changelog Theme Custom CSS -->
  <link rel="stylesheet" href="{{ "css/custom.css" | relURL }}">

  {{- partial "custom_head.html" . -}}
  {{ partial "microblog_head.html" . }}
</head>

<body>
  <header class="navbar">
    <div class="navbar-content">
      <h1 class="blog-title">
        <a href="/">{{ .Site.Title }}</a>
      </h1>
      
      <nav class="nav-links" id="nav-links">
        {{ range .Site.Menus.main }}
        <a href="{{ .URL }}">{{ .Name }}</a>
        {{ end }}
        <a href="/tags/">collections</a>
      </nav>
      
      <!-- Overflow menu for when nav links don't fit -->
      <div class="nav-overflow" id="nav-overflow">
        <button class="nav-overflow-toggle" id="nav-overflow-toggle" aria-label="More menu">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="nav-overflow-menu" id="nav-overflow-menu">
          {{ range .Site.Menus.main }}
          <a href="{{ .URL }}">{{ .Name }}</a>
          {{ end }}
          <a href="/tags/">collections</a>
        </div>
      </div>
      
      <div class="search-container">
        <input type="text" class="search-bar" placeholder="search..." id="search-input">
        <button class="search-toggle" id="search-toggle" aria-label="Search">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Mobile search dropdown -->
    <div class="search-dropdown" id="search-dropdown">
      <input type="text" class="search-bar" placeholder="search..." id="search-input-mobile">
    </div>
  </header>
  
  <main>
    {{- block "main" . }}{{- end }}
  </main>
  
  <footer>
    <div class="footer-content">
      <div class="footer-left">
        <span class="footer-title">{{ .Site.Title }}</span>
        <div class="footer-links">
          <a href="/tags/">collections</a>
          {{ range .Site.Menus.main }}
          <span>-</span>
          <a href="{{ .URL }}">{{ .Name }}</a>
          {{ end }}
        </div>
      </div>
      
      <div class="footer-right">
        <div class="footer-social">
          {{ if .Site.Params.twitter }}
          <a href="https://twitter.com/{{ .Site.Params.twitter }}" title="Twitter" aria-label="Twitter">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/>
            </svg>
          </a>
          {{ end }}
          {{ if .Site.Params.github }}
          <a href="https://github.com/{{ .Site.Params.github }}" title="GitHub" aria-label="GitHub">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/>
            </svg>
          </a>
          {{ end }}
        </div>
        
        <span class="footer-copyright">Â© {{ now.Year }}</span>
      </div>
    </div>
  </footer>

  {{- partial "custom_body.html" . -}}
  {{ partial "custom_footer.html" . }}
  {{ range .Site.Params.plugins_js }}
    <script src="{{ . }}"></script>
  {{ end }}
  
  <script>
    // Handle overflow menu toggle
    const overflowToggle = document.getElementById('nav-overflow-toggle');
    const overflowMenu = document.getElementById('nav-overflow-menu');
    
    if (overflowToggle && overflowMenu) {
      overflowToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        overflowMenu.classList.toggle('open');
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(e) {
        if (!overflowMenu.contains(e.target) && e.target !== overflowToggle) {
          overflowMenu.classList.remove('open');
        }
      });
    }
    
    // Handle mobile search toggle
    const searchToggle = document.getElementById('search-toggle');
    const searchDropdown = document.getElementById('search-dropdown');
    
    if (searchToggle && searchDropdown) {
      searchToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        searchDropdown.classList.toggle('open');
        if (searchDropdown.classList.contains('open')) {
          document.getElementById('search-input-mobile').focus();
        }
      });
      
      // Close search when clicking outside
      document.addEventListener('click', function(e) {
        if (!searchDropdown.contains(e.target) && e.target !== searchToggle) {
          searchDropdown.classList.remove('open');
        }
      });
    }
    
    // Handle search submission (both desktop and mobile)
    function handleSearch(input) {
      input.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          const query = this.value;
          if (query) {
            window.location.href = '/search/?q=' + encodeURIComponent(query);
          }
        }
      });
    }
    
    const searchInput = document.getElementById('search-input');
    const searchInputMobile = document.getElementById('search-input-mobile');
    
    if (searchInput) handleSearch(searchInput);
    if (searchInputMobile) handleSearch(searchInputMobile);
  </script>
</body>
</html>
